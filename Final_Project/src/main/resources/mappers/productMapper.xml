<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itwillbs.mappers.productMapper">
	
	<select id="orderProduct" resultType="com.itwillbs.domain.ProductDTO">
		<!-- SELECT * 
		FROM (SELECT @ROWNUM:=@ROWNUM+1 AS rank, A.product_title
				   , A.product_price, A.product_seller, A.product_pic
			  FROM product A, (SELECT @ROWNUM:=0) R ) B 
		<![CDATA[WHERE B.rank <= 20]]> -->
		
		
		SELECT *
		FROM( SELECT p.product_title
				   , p.product_price
				   , p.product_seller
				   , p.product_pic
				   , p.product_readcount
				   
			  FROM product p
			  <if test='GB.equals("date")'>
			  ORDER BY product_date DESC
			  </if>
			  <if test='GB.equals("views")'>
		 	  ORDER BY product_readcount DESC
			  </if>
			  <if test='GB.equals("wish")'>
			  JOIN wish w
			  on (p.product_num = w.product_num)
              GROUP BY p.product_title
              		 , p.product_price
              		 , p.product_seller
              		 , p.product_pic
              		 , p.product_readcount
			  ORDER BY count(w.product_num) DESC
			  </if>
			) A
		LIMIT 6
	</select>
	
	<select id="productInfo" resultType="com.itwillbs.domain.ProductDTO">
		SELECT product_num
			  ,product_seller
			  ,product_cate
			  ,product_title
			  ,product_content
			  ,product_price 
			  ,product_grade
			  ,product_pic
			  ,product_readcount
			  ,product_date
		FROM product
		WHERE product_num = #{productNum1}
	</select>
	
</mapper>